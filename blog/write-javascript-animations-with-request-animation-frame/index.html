<!DOCTYPE html><html><head><meta charSet="utf-8" class="next-head next-head"/><meta name="viewport" content="width=device-width, initial-scale=1" class="next-head"/><link rel="stylesheet" href="https://unpkg.com/tachyons@4.9.1/css/tachyons.min.css" class="next-head"/><link rel="preload" href="/_next/96bde6cf-367c-461a-9e1f-8ae0ecda7dba/pageblog.js" as="script"/><link rel="preload" href="/_next/96bde6cf-367c-461a-9e1f-8ae0ecda7dba/page/_error.js" as="script"/><link rel="preload" href="/_next/c9fab6ab1e35cb5bd5e9e65c04013a26/app.js" as="script"/></head><body><div id="__next"><div class="sans-serif measure center f4 f3" data-reactroot=""><article class="pt4 mr3 ml3"><a href="/">ðŸ‘ˆ Back</a><h1 class="green">Javascript Alternative to animateMotion</h1><div><p>I recently was trying to write a simple svg animation for a client.  To finish the animation I needed to animate a circle along a bezier path.  I quickly found  <a href="https://developer.mozilla.org/en-US/docs/Web/SVG/Element/animateMotion"><animateMotion></a> which made doing such an animation simple, but soon learned <code>animateMotion</code> is not supported by any versions of Internet Explorer. Since I had trouble finding any straight forward ways to do the animation using css, I decided to write the animation using javascript. Which brings us to:</p>
<h3>How to animate a svg circle along an svg path using javascript.</h3>
<p>To do our animation we'll write a function that will execute one &quot;step&quot; of our animation, and call that function repeatedly throughout the duration of our animation.  To help our animation to be more performant, we'll do all dom mutations within a callback function passed into  <code>requestAnimationFrame</code>.  Letting the browser call our animation function via <code>requestAnimationFrame</code> allows the browser to batch dom manipulations together, resulting in fewer unnecessary repaints, which means a more performant animation.</p>
<pre><code class="language-javascript">
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">animateProgress</span>(<span class="hljs-params">duration <span class="hljs-regexp">/*duration of animation*/</span>, animateElement <span class="hljs-regexp">/*callback function to animate our javascript element*/</span></span>) </span>{
  <span class="hljs-keyword">var</span> start = <span class="hljs-literal">null</span>;

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">step</span>(<span class="hljs-params">timestamp</span>) </span>{
    <span class="hljs-keyword">if</span> (!start) {
      start = timestamp;
    }
    <span class="hljs-keyword">var</span> timeSinceAnimationStart = timestamp - start;
    <span class="hljs-keyword">var</span> percentProgress = timeSinceAnimationStart / duration;

    animateElement(percentProgress);
    <span class="hljs-keyword">if</span> (timeSinceAnimationStart &lt; duration) {
      requestAnimationFrame(step);
    } <span class="hljs-keyword">else</span> {
      animateElement(<span class="hljs-number">1</span>); <span class="hljs-comment">//animation is Finished :D</span>
    }
  }

  requestAnimationFrame(step);
}
<span class="hljs-comment">/**
  from - initial value of animated element at beginning of animation
  to - final value of animated element at end of animation
  duration - time in milliseconds of animation
  animateElement - call back to animate element
*/</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">animate</span>(<span class="hljs-params">from, to, duration, animateElement</span>) </span>{
  animateProgress(duration, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">percentProgress</span>) </span>{
    <span class="hljs-keyword">var</span> nextValue = <span class="hljs-keyword">from</span> + (to - <span class="hljs-keyword">from</span>) * percentProgress;
    animateElement(nextValue);
  })
}
</code></pre>
<p>We can use our animate function like so:</p>
<pre><code class="language-javascript"><span class="hljs-keyword">var</span> redSquare = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'red-square'</span>)
animate(<span class="hljs-number">0</span>, <span class="hljs-number">100</span>, <span class="hljs-number">1000</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">nextValue</span>) </span>{
  redSquare.style.left = nextValue+<span class="hljs-string">'px'</span>;
})
</code></pre>
<iframe height='265' scrolling='no' title='Animation With requestAnimationFrame' src='//codepen.io/jeffreyyoung/embed/xPWmpM/?height=265&theme-id=0&default-tab=result&embed-version=2' frameborder='no' allowtransparency='true' allowfullscreen='true' style='width: 100%;'>See the Pen <a href='https://codepen.io/jeffreyyoung/pen/xPWmpM/'>Animation With requestAnimationFrame</a> by Jeff (<a href='https://codepen.io/jeffreyyoung'>@jeffreyyoung</a>) on <a href='https://codepen.io'>CodePen</a>.
</iframe>
<p>In the above code, we are animating the <code>left</code> style of the square element, from 0 to 100, over a period of 1000 milliseconds</p>
<p>Now if we wanted to animate a svg circle along a path, we could do so with the following code:</p>
<pre><code class="language-javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">animateCircleAlongPath</span>(<span class="hljs-params">circle, path</span>) </span>{
    animate(<span class="hljs-number">0</span>, path.getTotalLength(), <span class="hljs-number">3000</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">currentLengthOnPath</span>) </span>{
    <span class="hljs-keyword">var</span> nextCoords = path.getPointAtLength(currentLengthOnPath);
		circle.setAttribute(<span class="hljs-string">'cx'</span>, nextCoords.x);
		circle.setAttribute(<span class="hljs-string">'cy'</span>, nextCoords.y);
  })
}
</code></pre>
<iframe height='265' scrolling='no' title='SVG Animation With requestAnimationFrame' src='//codepen.io/jeffreyyoung/embed/QOmzXQ/?height=265&theme-id=0&default-tab=result&embed-version=2' frameborder='no' allowtransparency='true' allowfullscreen='true' style='width: 100%;'>See the Pen <a href='https://codepen.io/jeffreyyoung/pen/QOmzXQ/'>SVG Animation With requestAnimationFrame</a> by Jeff (<a href='https://codepen.io/jeffreyyoung'>@jeffreyyoung</a>) on <a href='https://codepen.io'>CodePen</a>.
</iframe></div></article></div></div><div id="__next-error"></div><script>
          __NEXT_DATA__ = {"props":{"post":{"html":"\u003cp\u003eI recently was trying to write a simple svg animation for a client.  To finish the animation I needed to animate a circle along a bezier path.  I quickly found  \u003ca href=\"https://developer.mozilla.org/en-US/docs/Web/SVG/Element/animateMotion\"\u003e\u003canimateMotion\u003e\u003c/a\u003e which made doing such an animation simple, but soon learned \u003ccode\u003eanimateMotion\u003c/code\u003e is not supported by any versions of Internet Explorer. Since I had trouble finding any straight forward ways to do the animation using css, I decided to write the animation using javascript. Which brings us to:\u003c/p\u003e\n\u003ch3\u003eHow to animate a svg circle along an svg path using javascript.\u003c/h3\u003e\n\u003cp\u003eTo do our animation we'll write a function that will execute one \u0026quot;step\u0026quot; of our animation, and call that function repeatedly throughout the duration of our animation.  To help our animation to be more performant, we'll do all dom mutations within a callback function passed into  \u003ccode\u003erequestAnimationFrame\u003c/code\u003e.  Letting the browser call our animation function via \u003ccode\u003erequestAnimationFrame\u003c/code\u003e allows the browser to batch dom manipulations together, resulting in fewer unnecessary repaints, which means a more performant animation.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003e\n\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eanimateProgress\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eduration \u003cspan class=\"hljs-regexp\"\u003e/*duration of animation*/\u003c/span\u003e, animateElement \u003cspan class=\"hljs-regexp\"\u003e/*callback function to animate our javascript element*/\u003c/span\u003e\u003c/span\u003e) \u003c/span\u003e{\n  \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e start = \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e;\n\n  \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003estep\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003etimestamp\u003c/span\u003e) \u003c/span\u003e{\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (!start) {\n      start = timestamp;\n    }\n    \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e timeSinceAnimationStart = timestamp - start;\n    \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e percentProgress = timeSinceAnimationStart / duration;\n\n    animateElement(percentProgress);\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (timeSinceAnimationStart \u0026lt; duration) {\n      requestAnimationFrame(step);\n    } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n      animateElement(\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e); \u003cspan class=\"hljs-comment\"\u003e//animation is Finished :D\u003c/span\u003e\n    }\n  }\n\n  requestAnimationFrame(step);\n}\n\u003cspan class=\"hljs-comment\"\u003e/**\n  from - initial value of animated element at beginning of animation\n  to - final value of animated element at end of animation\n  duration - time in milliseconds of animation\n  animateElement - call back to animate element\n*/\u003c/span\u003e\n\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eanimate\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003efrom, to, duration, animateElement\u003c/span\u003e) \u003c/span\u003e{\n  animateProgress(duration, \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003epercentProgress\u003c/span\u003e) \u003c/span\u003e{\n    \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e nextValue = \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e + (to - \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e) * percentProgress;\n    animateElement(nextValue);\n  })\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eWe can use our animate function like so:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e redSquare = \u003cspan class=\"hljs-built_in\"\u003edocument\u003c/span\u003e.getElementById(\u003cspan class=\"hljs-string\"\u003e'red-square'\u003c/span\u003e)\nanimate(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e100\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e, \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003enextValue\u003c/span\u003e) \u003c/span\u003e{\n  redSquare.style.left = nextValue+\u003cspan class=\"hljs-string\"\u003e'px'\u003c/span\u003e;\n})\n\u003c/code\u003e\u003c/pre\u003e\n\u003ciframe height='265' scrolling='no' title='Animation With requestAnimationFrame' src='//codepen.io/jeffreyyoung/embed/xPWmpM/?height=265\u0026theme-id=0\u0026default-tab=result\u0026embed-version=2' frameborder='no' allowtransparency='true' allowfullscreen='true' style='width: 100%;'\u003eSee the Pen \u003ca href='https://codepen.io/jeffreyyoung/pen/xPWmpM/'\u003eAnimation With requestAnimationFrame\u003c/a\u003e by Jeff (\u003ca href='https://codepen.io/jeffreyyoung'\u003e@jeffreyyoung\u003c/a\u003e) on \u003ca href='https://codepen.io'\u003eCodePen\u003c/a\u003e.\n\u003c/iframe\u003e\n\u003cp\u003eIn the above code, we are animating the \u003ccode\u003eleft\u003c/code\u003e style of the square element, from 0 to 100, over a period of 1000 milliseconds\u003c/p\u003e\n\u003cp\u003eNow if we wanted to animate a svg circle along a path, we could do so with the following code:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eanimateCircleAlongPath\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003ecircle, path\u003c/span\u003e) \u003c/span\u003e{\n    animate(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, path.getTotalLength(), \u003cspan class=\"hljs-number\"\u003e3000\u003c/span\u003e, \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003ecurrentLengthOnPath\u003c/span\u003e) \u003c/span\u003e{\n    \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e nextCoords = path.getPointAtLength(currentLengthOnPath);\n\t\tcircle.setAttribute(\u003cspan class=\"hljs-string\"\u003e'cx'\u003c/span\u003e, nextCoords.x);\n\t\tcircle.setAttribute(\u003cspan class=\"hljs-string\"\u003e'cy'\u003c/span\u003e, nextCoords.y);\n  })\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ciframe height='265' scrolling='no' title='SVG Animation With requestAnimationFrame' src='//codepen.io/jeffreyyoung/embed/QOmzXQ/?height=265\u0026theme-id=0\u0026default-tab=result\u0026embed-version=2' frameborder='no' allowtransparency='true' allowfullscreen='true' style='width: 100%;'\u003eSee the Pen \u003ca href='https://codepen.io/jeffreyyoung/pen/QOmzXQ/'\u003eSVG Animation With requestAnimationFrame\u003c/a\u003e by Jeff (\u003ca href='https://codepen.io/jeffreyyoung'\u003e@jeffreyyoung\u003c/a\u003e) on \u003ca href='https://codepen.io'\u003eCodePen\u003c/a\u003e.\n\u003c/iframe\u003e","meta":{"title":"Javascript Alternative to animateMotion","image":"/static/images/byu-big-data.png","imageDescription":"Screen shot of the current website","category":"blog","id":203948902,"order":10,"description":"How to write a javascript alternative to animateMotion","createdTime":"Wed Nov 22 2017 00:38:32 GMT-0700 (MST)"}}},"pathname":"blog","query":{"id":"write-javascript-animations-with-request-animation-frame"},"buildId":"96bde6cf-367c-461a-9e1f-8ae0ecda7dba","buildStats":{"app.js":{"hash":"c9fab6ab1e35cb5bd5e9e65c04013a26"}},"assetPrefix":"","nextExport":true,"err":null,"chunks":[]}
          module={}
          __NEXT_LOADED_PAGES__ = []
          __NEXT_LOADED_CHUNKS__ = []

          __NEXT_REGISTER_PAGE = function (route, fn) {
            __NEXT_LOADED_PAGES__.push({ route: route, fn: fn })
          }

          __NEXT_REGISTER_CHUNK = function (chunkName, fn) {
            __NEXT_LOADED_CHUNKS__.push({ chunkName: chunkName, fn: fn })
          }
        </script><script async="" id="__NEXT_PAGE__blog" type="text/javascript" src="/_next/96bde6cf-367c-461a-9e1f-8ae0ecda7dba/pageblog.js"></script><script async="" id="__NEXT_PAGE__/_error" type="text/javascript" src="/_next/96bde6cf-367c-461a-9e1f-8ae0ecda7dba/page/_error.js"></script><script type="text/javascript" src="/_next/c9fab6ab1e35cb5bd5e9e65c04013a26/app.js" async=""></script></body></html>