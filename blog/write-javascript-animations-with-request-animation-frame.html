<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta content="width=device-width,initial-scale=1,shrink-to-fit=no" name="viewport"><meta content="#000000" name="theme-color"><script async>if (window && !window.__j_cache) { window.__j_cache = {};}
      if (navigator.userAgent === 'ReactSnap') {
        window && window.lazySizesConfig.loadMode = 0;
      };</script><link href="/manifest.json" rel="manifest"><link href="/favicon.ico" rel="shortcut icon"><style type="text/css">#root,body,html{width:100%;height:100%;margin:0}html{line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}body,div,html{-webkit-box-sizing:border-box;box-sizing:border-box}</style><link href="/static/css/main.303e1101.css" rel="stylesheet" as="style" onload="this.rel='stylesheet'"><noscript>&lt;link href="/static/css/main.303e1101.css" rel="stylesheet"></noscript><script async>!function(e){"use strict";var t=function(t,n,r){function o(e){if(i.body)return e();setTimeout(function(){o(e)})}function a(){d.addEventListener&&d.removeEventListener("load",a),d.media=r||"all"}var l,i=e.document,d=i.createElement("link");if(n)l=n;else{var s=(i.body||i.getElementsByTagName("head")[0]).childNodes;l=s[s.length-1]}var u=i.styleSheets;d.rel="stylesheet",d.href=t,d.media="only x",o(function(){l.parentNode.insertBefore(d,n?l:l.nextSibling)});var f=function(e){for(var t=d.href,n=u.length;n--;)if(u[n].href===t)return e();setTimeout(function(){f(e)})};return d.addEventListener&&d.addEventListener("load",a),d.onloadcssdefined=f,f(a),d};"undefined"!=typeof exports?exports.loadCSS=t:e.loadCSS=t}("undefined"!=typeof global?global:this),function(e){if(e.loadCSS){var t=loadCSS.relpreload={};if(t.support=function(){try{return e.document.createElement("link").relList.supports("preload")}catch(e){return!1}},t.poly=function(){for(var t=e.document.getElementsByTagName("link"),n=0;n<t.length;n++){var r=t[n];"preload"===r.rel&&"style"===r.getAttribute("as")&&(e.loadCSS(r.href,r,r.getAttribute("media")),r.rel=null)}},!t.support()){t.poly();var n=e.setInterval(t.poly,300);e.addEventListener&&e.addEventListener("load",function(){t.poly(),e.clearInterval(n)}),e.attachEvent&&e.attachEvent("onload",function(){e.clearInterval(n)})}}}(this);</script><script async src="https://jeffreyyoung.disqus.com/embed.js"></script><title>Javascript Alternative to animateMotion</title><meta content="How to write a javascript alternative to animateMotion" name="description" data-react-helmet="true"><script data-react-helmet="true">if (window && !window.__j_cache) { window.__j_cache = {};}
						window.__j_cache['/blog/write-javascript-animations-with-request-animation-frame'] = {"post":{"html":"<p>I recently was trying to write a simple svg animation for a client.  To finish the animation I needed to animate a circle along a bezier path.  I quickly found  <a href=\"https://developer.mozilla.org/en-US/docs/Web/SVG/Element/animateMotion\"><animateMotion></a> which made doing such an animation simple, but soon learned <code>animateMotion</code> is not supported by any versions of Internet Explorer. Since I had trouble finding any straight forward ways to do the animation using css, I decided to write the animation using javascript. Which brings us to:</p>\n<h3>How to animate a svg circle along an svg path using javascript.</h3>\n<p>To do our animation we'll write a function that will execute one &quot;step&quot; of our animation, and call that function repeatedly throughout the duration of our animation.  To help our animation to be more performant, we'll do all dom mutations within a callback function passed into  <code>requestAnimationFrame</code>.  Letting the browser call our animation function via <code>requestAnimationFrame</code> allows the browser to batch dom manipulations together, resulting in fewer unnecessary repaints, which means a more performant animation.</p>\n<pre><code class=\"language-javascript\">\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">animateProgress</span>(<span class=\"hljs-params\">duration <span class=\"hljs-regexp\">/*duration of animation*/</span>, animateElement <span class=\"hljs-regexp\">/*callback function to animate our javascript element*/</span></span>) </span>{\n  <span class=\"hljs-keyword\">var</span> start = <span class=\"hljs-literal\">null</span>;\n\n  <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">step</span>(<span class=\"hljs-params\">timestamp</span>) </span>{\n    <span class=\"hljs-keyword\">if</span> (!start) {\n      start = timestamp;\n    }\n    <span class=\"hljs-keyword\">var</span> timeSinceAnimationStart = timestamp - start;\n    <span class=\"hljs-keyword\">var</span> percentProgress = timeSinceAnimationStart / duration;\n\n    animateElement(percentProgress);\n    <span class=\"hljs-keyword\">if</span> (timeSinceAnimationStart &lt; duration) {\n      requestAnimationFrame(step);\n    } <span class=\"hljs-keyword\">else</span> {\n      animateElement(<span class=\"hljs-number\">1</span>); <span class=\"hljs-comment\">//animation is Finished :D</span>\n    }\n  }\n\n  requestAnimationFrame(step);\n}\n<span class=\"hljs-comment\">/**\n  from - initial value of animated element at beginning of animation\n  to - final value of animated element at end of animation\n  duration - time in milliseconds of animation\n  animateElement - call back to animate element\n*/</span>\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">animate</span>(<span class=\"hljs-params\">from, to, duration, animateElement</span>) </span>{\n  animateProgress(duration, <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">percentProgress</span>) </span>{\n    <span class=\"hljs-keyword\">var</span> nextValue = <span class=\"hljs-keyword\">from</span> + (to - <span class=\"hljs-keyword\">from</span>) * percentProgress;\n    animateElement(nextValue);\n  })\n}\n</code></pre>\n<p>We can use our animate function like so:</p>\n<pre><code class=\"language-javascript\"><span class=\"hljs-keyword\">var</span> redSquare = <span class=\"hljs-built_in\">document</span>.getElementById(<span class=\"hljs-string\">'red-square'</span>)\nanimate(<span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">100</span>, <span class=\"hljs-number\">1000</span>, <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">nextValue</span>) </span>{\n  redSquare.style.left = nextValue+<span class=\"hljs-string\">'px'</span>;\n})\n</code></pre>\n<iframe height='265' scrolling='no' title='Animation With requestAnimationFrame' src='//codepen.io/jeffreyyoung/embed/xPWmpM/?height=265&theme-id=0&default-tab=result&embed-version=2' frameborder='no' allowtransparency='true' allowfullscreen='true' style='width: 100%;'>See the Pen <a href='https://codepen.io/jeffreyyoung/pen/xPWmpM/'>Animation With requestAnimationFrame</a> by Jeff (<a href='https://codepen.io/jeffreyyoung'>@jeffreyyoung</a>) on <a href='https://codepen.io'>CodePen</a>.\n</iframe>\n<p>In the above code, we are animating the <code>left</code> style of the square element, from 0 to 100, over a period of 1000 milliseconds</p>\n<p>Now if we wanted to animate a svg circle along a path, we could do so with the following code:</p>\n<pre><code class=\"language-javascript\"><span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">animateCircleAlongPath</span>(<span class=\"hljs-params\">circle, path</span>) </span>{\n    animate(<span class=\"hljs-number\">0</span>, path.getTotalLength(), <span class=\"hljs-number\">3000</span>, <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">currentLengthOnPath</span>) </span>{\n    <span class=\"hljs-keyword\">var</span> nextCoords = path.getPointAtLength(currentLengthOnPath);\n\t\tcircle.setAttribute(<span class=\"hljs-string\">'cx'</span>, nextCoords.x);\n\t\tcircle.setAttribute(<span class=\"hljs-string\">'cy'</span>, nextCoords.y);\n  })\n}\n</code></pre>\n<iframe height='265' scrolling='no' title='SVG Animation With requestAnimationFrame' src='//codepen.io/jeffreyyoung/embed/QOmzXQ/?height=265&theme-id=0&default-tab=result&embed-version=2' frameborder='no' allowtransparency='true' allowfullscreen='true' style='width: 100%;'>See the Pen <a href='https://codepen.io/jeffreyyoung/pen/QOmzXQ/'>SVG Animation With requestAnimationFrame</a> by Jeff (<a href='https://codepen.io/jeffreyyoung'>@jeffreyyoung</a>) on <a href='https://codepen.io'>CodePen</a>.\n</iframe>","meta":{"title":"Javascript Alternative to animateMotion","image":"/images/byu-big-data.png","imageDescription":"Screen shot of the current website","category":"blog","id":203948902,"order":10,"description":"How to write a javascript alternative to animateMotion","createdTime":"Wed Nov 22 2017 00:38:32 GMT-0700 (MST)","imagePlaceholder":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAANCAYAAACZ3F9/AAAACXBIWXMAABYlAAAWJQFJUiTwAAAB+0lEQVQokUWSOW8TURSFv/dm3ixexkbZUJgkIiwFoBApQkKio+Cn0tNSAgo1FSESIQsW2MZxMhnP5rdQmJjbHB3d4p7z6fqDwU+nVMDtBEGAUgpjDHmeI6UEwFpLGIZL79/cLJbOOYqioNVqkaYpTdMwHA4RQuCcW6pSCq01stfrLS/FcUxVVdR1zXQ6XURw4Ps+SZLgeR5BELC6uoqMoghVjpjNZstIk8mE/HKCKzIQMDr6QH11QZqmbG5ukiQJsqoqys49yrJEKYUQgjzPEWEEKoRsQOvRK3BzgiBACIGUEj9JEqIoRCcdjDEURYExBoCyrjj//B6XHfP42QHz3QOsMZTZGPn77AefDt9hrWU8HqO1XhJux216+2+I9l5TbLzgy8e3XF5PyI4P8WdzzUa6x5/BKfO5RobtBRPnkErxcv8pVf2E4a/vRLYmK2fQ20LW2hA4OLs4ZXT+jar6R1MIurqmml7jBz47D/dRrTWkVYS9LXzleQDEccj2dp+ZFAjpYYwh05bLk6+UW8/R12dIUrpFTqN85G2fpLuOiFJCI+n3+zRNQ+UEbu0BO702O/d3Wb+zAkZDdYWvtcbzPGQUc9No4s5dRqMRQfD/DbPTI6KNFZo5iFYHIbpI3/cRQgAOMz1Ba40QAmst1lqcc+hknbz0cCxqVVXFX2+N8OIVqCC7AAAAAElFTkSuQmCC"}}}
						
						console.log('mew')</script><link href="https://c.disquscdn.com/next/embed/styles/lounge.c61e7efbeb6a4ac7d81f7c61a454a72c.css" rel="preload" as="style"><link href="https://c.disquscdn.com/next/embed/common.bundle.8edffe1405dcc2d5eb5ee9d96a2866d1.js" rel="preload" as="script"><link href="https://c.disquscdn.com/next/embed/lounge.bundle.b4f0f934e300a59410ed8012277d0fd8.js" rel="preload" as="script"><link href="https://disqus.com/next/config.js" rel="preload" as="script"><script async src="https://c.disquscdn.com/next/embed/alfalfa.4a5fcca1fe50a757044dfd331b660625.js" charset="UTF-8"></script></head><body><div id="root"><div class="sans-serif"><div class=""><section class="Project bg-white"><div class="center black-90 min-vh-100 pa3 pt5 measure-wide"><nav><a class="BackArrow no-underline underline-hover blue" href="/blog"><span role="img" aria-label="back">ðŸ‘ˆ</span>Blog</a></nav><div><h1 class="f1">Javascript Alternative to animateMotion</h1><h3 class="f3 red">How to write a javascript alternative to animateMotion</h3><article class="lh-copy markdown-post markdown-body pb5"><p>I recently was trying to write a simple svg animation for a client. To finish the animation I needed to animate a circle along a bezier path. I quickly found<a href="https://developer.mozilla.org/en-US/docs/Web/SVG/Element/animateMotion"><animatemotion></animatemotion></a>which made doing such an animation simple, but soon learned<code>animateMotion</code>is not supported by any versions of Internet Explorer. Since I had trouble finding any straight forward ways to do the animation using css, I decided to write the animation using javascript. Which brings us to:</p><h3>How to animate a svg circle along an svg path using javascript.</h3><p>To do our animation we'll write a function that will execute one "step" of our animation, and call that function repeatedly throughout the duration of our animation. To help our animation to be more performant, we'll do all dom mutations within a callback function passed into<code>requestAnimationFrame</code>. Letting the browser call our animation function via<code>requestAnimationFrame</code>allows the browser to batch dom manipulations together, resulting in fewer unnecessary repaints, which means a more performant animation.</p><pre><code class="language-javascript">
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">animateProgress</span>(<span class="hljs-params">duration <span class="hljs-regexp">/*duration of animation*/</span>, animateElement <span class="hljs-regexp">/*callback function to animate our javascript element*/</span></span>) </span>{
  <span class="hljs-keyword">var</span> start = <span class="hljs-literal">null</span>;

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">step</span>(<span class="hljs-params">timestamp</span>) </span>{
    <span class="hljs-keyword">if</span> (!start) {
      start = timestamp;
    }
    <span class="hljs-keyword">var</span> timeSinceAnimationStart = timestamp - start;
    <span class="hljs-keyword">var</span> percentProgress = timeSinceAnimationStart / duration;

    animateElement(percentProgress);
    <span class="hljs-keyword">if</span> (timeSinceAnimationStart &lt; duration) {
      requestAnimationFrame(step);
    } <span class="hljs-keyword">else</span> {
      animateElement(<span class="hljs-number">1</span>); <span class="hljs-comment">//animation is Finished :D</span>
    }
  }

  requestAnimationFrame(step);
}
<span class="hljs-comment">/**
  from - initial value of animated element at beginning of animation
  to - final value of animated element at end of animation
  duration - time in milliseconds of animation
  animateElement - call back to animate element
*/</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">animate</span>(<span class="hljs-params">from, to, duration, animateElement</span>) </span>{
  animateProgress(duration, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">percentProgress</span>) </span>{
    <span class="hljs-keyword">var</span> nextValue = <span class="hljs-keyword">from</span> + (to - <span class="hljs-keyword">from</span>) * percentProgress;
    animateElement(nextValue);
  })
}
</code></pre><p>We can use our animate function like so:</p><pre><code class="language-javascript"><span class="hljs-keyword">var</span> redSquare = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'red-square'</span>)
animate(<span class="hljs-number">0</span>, <span class="hljs-number">100</span>, <span class="hljs-number">1000</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">nextValue</span>) </span>{
  redSquare.style.left = nextValue+<span class="hljs-string">'px'</span>;
})
</code></pre><iframe height="265" scrolling="no" title="Animation With requestAnimationFrame" src="//codepen.io/jeffreyyoung/embed/xPWmpM/?height=265&theme-id=0&default-tab=result&embed-version=2" frameborder="no" allowtransparency="true" allowfullscreen style="width:100%">See the Pen &lt;a href='https://codepen.io/jeffreyyoung/pen/xPWmpM/'>Animation With requestAnimationFrame&lt;/a> by Jeff (&lt;a href='https://codepen.io/jeffreyyoung'>@jeffreyyoung&lt;/a>) on &lt;a href='https://codepen.io'>CodePen&lt;/a>.</iframe><p>In the above code, we are animating the<code>left</code>style of the square element, from 0 to 100, over a period of 1000 milliseconds</p><p>Now if we wanted to animate a svg circle along a path, we could do so with the following code:</p><pre><code class="language-javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">animateCircleAlongPath</span>(<span class="hljs-params">circle, path</span>) </span>{
    animate(<span class="hljs-number">0</span>, path.getTotalLength(), <span class="hljs-number">3000</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">currentLengthOnPath</span>) </span>{
    <span class="hljs-keyword">var</span> nextCoords = path.getPointAtLength(currentLengthOnPath);
		circle.setAttribute(<span class="hljs-string">'cx'</span>, nextCoords.x);
		circle.setAttribute(<span class="hljs-string">'cy'</span>, nextCoords.y);
  })
}
</code></pre><iframe height="265" scrolling="no" title="SVG Animation With requestAnimationFrame" src="//codepen.io/jeffreyyoung/embed/QOmzXQ/?height=265&theme-id=0&default-tab=result&embed-version=2" frameborder="no" allowtransparency="true" allowfullscreen style="width:100%">See the Pen &lt;a href='https://codepen.io/jeffreyyoung/pen/QOmzXQ/'>SVG Animation With requestAnimationFrame&lt;/a> by Jeff (&lt;a href='https://codepen.io/jeffreyyoung'>@jeffreyyoung&lt;/a>) on &lt;a href='https://codepen.io'>CodePen&lt;/a>.</iframe></article><p>Anything you would have done differently? Anything that could be done better?</p><hr><div id="disqus_thread"><iframe id="dsq-app4182" name="dsq-app4182" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" width="100%" src="https://disqus.com/embed/comments/?base=default&f=jeffreyyoung&t_u=http%3A%2F%2Flocalhost%3A45678%2Fblog%2Fwrite-javascript-animations-with-request-animation-frame&t_d=Javascript%20Alternative%20to%20animateMotion&t_t=Javascript%20Alternative%20to%20animateMotion&s_o=default#version=e90c518d9f9439681a4b12a8675f85cb" style="width:1px!important;min-width:100%!important;border:none!important;overflow:hidden!important;height:403px!important" horizontalscrolling="no" verticalscrolling="no"></iframe></div></div></div></section></div></div></div><script async defer>if (navigator.userAgent === 'ReactSnap') {
      setTimeout(function() {
        console.log('SETTING ATTRIBUTE');
        document.querySelectorAll('script')
          .forEach(s => {
            console.log('SETTING ATTRIBUTE');
            s.setAttribute('async', '');
          });
      })
    };</script><script async src="/static/js/main.bd645c0b.js" type="text/javascript"></script><iframe style="display:none"></iframe></body></html>